---
import Layout from '../layouts/Layout.astro'
import { getBlogs, getBlogDetail, type Blog } from '../library/microcms'
import { convertEmoji } from '../utils/convertEmoji'
// 詳細記事ページの全パスを取得
export async function getStaticPaths() {
	const response = await getBlogs({ fields: ['id'] })
	return response.contents.map((content: Blog) => ({
		params: {
			blogId: content.id,
		},
	}))
}

//記事の詳細情報を取得
const { blogId } = Astro.params
const blog = await getBlogDetail(blogId as string)
const date = new Date(blog.publishedAt)
---

<Layout title={blog.title} description={blog.description}>
	<main class="flex-grow mx-auto">
		<div class="grid gap-8 p-1">
			<div class="text-8xl text-center">{convertEmoji(blog.thumbnail[0])}</div>
			<h1 class="text-xl font-semibold">{blog.title}</h1>
			<div>
				<div class="mb-2 text-center text-sm text-gray-500">
					<time datetime={date.toISOString()}>
						公開日時：{
							date.toLocaleDateString('ja-JP', {
								year: 'numeric',
								month: 'short',
								day: 'numeric',
							})
						}
					</time>
				</div>
			</div>
			<div class="content-wrapper">
				<div set:html={blog.content} />
			</div>
		</div>
	</main>

	<style>
		main {
			padding: 1em;
			max-width: 60ch;
		}
		.content-wrapper {
			h2 {
				margin-top: 2rem;
				margin-bottom: 1rem;
				font-weight: bold;
				font-size: 1.25rem;
				background-color: rgb(226 232 240);
				padding: 4px 0;
				border-radius: 4px;
			}
			h3 {
				margin-top: 2rem;
				margin-bottom: 1rem;
				font-weight: bold;
				font-size: 1.125rem;
			}
			p {
				margin-top: 1.25em;
				margin-bottom: 1.25em;
				font-size: 1rem;
			}
			ul {
				list-style-type: disc;
				padding-left: 1.625em;
				font-size: 1rem;
			}
			li {
				padding-left: 0.375em;
				margin-top: 0.5em;
				margin-bottom: 0.5em;
			}
			a {
				text-decoration: underline;
				color: #0066c0;
				&:hover {
					opacity: 0.7;
					text-decoration: none;
				}
			}
		}
	</style>
</Layout>
