---
import Layout from '../../layouts/Layout.astro'
import { getBlogs, getBlogDetail, type Blog } from '../../library/microcms'
import { convertEmoji } from '../../utils/convertEmoji'
import { ja } from 'date-fns/locale'
import { format } from 'date-fns'
export const prerender = true
// 詳細記事ページの全パスを取得
export async function getStaticPaths() {
	const response = await getBlogs({ fields: ['id'] })
	return response.contents.map((content: Blog) => ({
		params: {
			id: content.id,
		},
	}))
}

//記事の詳細情報を取得
const { id } = Astro.params
const blog = await getBlogDetail(id as string)
---

<Layout title={blog.title} description={blog.description}>
	<main class="flex-grow mx-auto">
		<div class="grid gap-8 p-1">
			<div class="text-8xl text-center">{convertEmoji(blog.thumbnail[0])}</div>
			<h1 class="text-xl font-semibold">{blog.title}</h1>
			<div>
				<p class="text-center text-sm text-gray-500">
					公開日時：{format(blog.publishedAt, 'yyyy年MM月dd日', { locale: ja })}
				</p>
			</div>
			<div class="content-wrapper">
				<div set:html={blog.content} />
			</div>
		</div>
	</main>

	<style>
		main {
			padding: 1em;
			max-width: 60ch;
		}
		.content-wrapper {
			h2 {
				margin-top: 2rem;
				margin-bottom: 1rem;
				font-weight: bold;
				font-size: 1.25rem;
				background-color: rgb(226 232 240);
				padding: 4px 0;
				border-radius: 4px;
			}
			h3 {
				margin-top: 2rem;
				margin-bottom: 1rem;
				font-weight: bold;
				font-size: 1.125rem;
			}
			p {
				margin-top: 1.25em;
				margin-bottom: 1.25em;
				font-size: 1rem;
			}
			ul {
				list-style-type: disc;
				padding-left: 1.625em;
				font-size: 1rem;
			}
			li {
				padding-left: 0.375em;
				margin-top: 0.5em;
				margin-bottom: 0.5em;
			}
			a {
				text-decoration: underline;
				color: #0066c0;
				&:hover {
					opacity: 0.7;
					text-decoration: none;
				}
			}
		}
	</style>
</Layout>
